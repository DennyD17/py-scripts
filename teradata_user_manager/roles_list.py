# -*- coding: utf-8 -*-
import re


roles_list = {
'001_MIS_RETAIL Администратор': '001_MIS_Retail_Adm', 
'001_MIS_RETAIL Чтение данных': '001_MIS_Retail_Reader',
'001_MIS_RETAIL Изменение данных':	'001_MIS_Retail_User',
'001_MIS_RETAIL Собственные объекты': '001_MIS_Retail_User_Lite',
'001_MIS_Retail_Channel Администратор':	'001_MIS_Retail_Channel_Adm',
'001_MIS_Retail_Channel Чтение данных': '001_MIS_Retail_Channel_Reader',
'001_MIS_Retail_Channel Изменение данных': '001_MIS_Retail_Channel_User',
'001_MIS_Retail_Channel Собственные объекты': '001_MIS_Retail_Chnl_User_Lite',
'001_MIS_RETAIL_REPORTING Администратор': '001_MIS_RTL_REP_Adm',
'001_MIS_RETAIL_REPORTING Чтение данных': '001_MIS_RTL_REP_Reader',
'001_MIS_RETAIL_REPORTING Изменение данных': '001_MIS_RTL_REP_User',
'001_MIS_RETAIL_REPORTING Собственные объекты': '001_MIS_RTL_REP_User_Lite',
'001_MIS_Retail_Bank21 Администратор': '001_MIS_Retail_B21_Adm',        
'001_MIS_Retail_Bank21 Чтение данных': '001_MIS_Retail_B21_Reader',
'001_MIS_Retail_Bank21 Изменение данных': '001_MIS_Retail_B21_User',
'001_MIS_Retail_Bank21 Собственные объекты':	'001_MIS_Retail_B21_User_Lite',
'002_MIS_ALM Администратор': '002_MIS_ALM_Adm',
'002_MIS_ALM Чтение данных': '002_MIS_ALM_Reader',
'002_MIS_ALM Изменение данных': '002_MIS_ALM_User',
'002_MIS_ALM Собственные объекты': '002_MIS_ALM_User_Lite',
'003_MIS_Sandbox Администратор': '003_MIS_Adm',                   
'003_MIS_Sandbox Чтение данных': '003_MIS_Reader',
'003_MIS_Sandbox Изменение данных': '003_MIS_User',
'003_MIS_Sandbox Модификация объектов': '003_MIS_User_Lite',
'005_OAKB Администратор': '005_OAKB_Adm',
'005_OAKB Чтение данных': '005_OAKB_Reader',
'005_OAKB Изменение данных': '005_OAKB_User',
'005_OAKB Собственные объекты': '005_OAKB_User_Lite',
'006_OAKB Администратор': '006_OAKB_Adm',
'006_OAKB Чтение данных': '006_OAKB_Reader',
'006_OAKB Изменение данных': '006_OAKB_User',
'006_OAKB Собственные объекты': '006_OAKB_User_Lite',
'007_TRDM Администратор': '007_TRDM_Adm',
'007_TRDM Чтение данных': '007_TRDM_Reader',
'007_TRDM Изменение данных': '007_TRDM_User',
'008_MISVDDF Администратор': '008_MISVDDF_Adm',
'008_MISVDDF Чтение данных': '008_MISVDDF_Reader',
'008_MISVDDF Изменение данных': '008_MISVDDF_User',
'008_MISVDDF Собственные объекты': '008_MISVDDF_User_Lite',
'008_SZB Администратор':	'008_SZB_Adm',
'008_SZB Чтение данных':	'008_SZB_Reader',
'008_SZB Изменение данных': '008_SZB_User',
'008_SZB Соственные объекты':	'008_SZB_User_Lite',
'008_SZB_REP Администратор': '008_SZB_Rep_Adm',
'08_SZB_REP Чтение данных': '008_SZB_Rep_Reader',
'008_SZB_REP Изменение данных': '008_SZB_Rep_User',
'008_SZB_REP Соственные объекты': '008_SZB_Rep_User_Lite',
'009_PVB Администратор':	'009_PVB_Adm',
'009_PVB Чтение данных': '009_PVB_Reader',
'009_PVB Изменение данных': '009_PVB_User',
'009_PVB Соственные объекты':	'009_PVB_User_Lite',
'010_MIS_OKFL Администратор': '010_MIS_OKFL_Adm',
'010_MIS_OKFL Чтение данных':	'010_MIS_OKFL_Reader',
'010_MIS_OKFL Изменение данных': '010_MIS_OKFL_User',
'011_MIS_OB Администратор': '011_MIS_OB_Adm',
'011_MIS_OB Чтение данных': '011_MIS_OB_Reader',
'011_MIS_OB Изменение данных': '011_MIS_OB_User',
'011_MIS_OB Собственные объекты': '011_MIS_OB_User_Lite',
'012_MIS_DT Администратор': '012_MISDT_Adm',
'012_MIS_DT Чтение данных': '012_MISDT_Reader',
'012_MIS_DT Изменение данных': '012_MISDT_User',
'012_MIS_DT Собственные объекты': '012_MISDT_User_Lite',
'013_DF Администратор': '013_DF_Adm',
'013_DF Чтение данных': '013_DF_Reader',
'013_DF Изменение данных': '013_DF_User',
'013_DF Собственные объекты':	'013_DF_User_Lite',
'013_DF_Service Администратор': '013_DF_Service_Adm',
'013_DF_Service Чтение данных': '013_DF_Service_Reader',
'013_DF_Service Изменение данных': '013_DF_Service_User',
'013_DF_Service Собственные объекты': '013_DF_Service_User_Lite',
'014_DF Администратор': '014_DF_Adm',
'014_DF Чтение данных': '014_DF_Reader',
'014_DF Изменение данных': '014_DF_User',
'014_DF Собственные объекты': '014_DF_User_Lite',
'015_DF Администратор': '015_DF_Adm',
'015_DF Чтение данных': '015_DF_Reader',
'015_DF Изменение данных': '015_DF_User',
'015_DF Собственные объекты': '015_DF_User_Lite',
'015_ERM Администратор':	'015_ERM_Adm',
'015_ERM Чтение данных':	'015_ERM_Reader',
'015_ERM Изменение данных': '015_ERM_User',
'016_DF_OAKB Администратор': '016_DF_OAKB_Adm',
'016_DF_OAKB Чтение данных': '016_DF_OAKB_Reader',
'016_DF_OAKB Изменение данных': '016_DF_OAKB_User',
'016_DF_OAKB Собственные объекты':	'016_DF_OAKB_User_Lite',
'017_PipeLine Администратор':	'017_PipeLine_Adm',
'017_PipeLine Чтение данных': '017_PipeLine_Reader',
'017_PipeLine Изменение данных': '017_PipeLine_User',
'018_ODUL Администратор': '018_ODUL_Adm',
'018_ODUL Чтение данных': '018_ODUL_Reader',
'018_ODUL Изменение данных': '018_ODUL_User',
'018_ODUL Собственные объекты': '018_ODUL_User_Lite',
'019_UAKB Администратор': '019_UAKB_Adm',
'019_UAKB Чтение данных': '019_UAKB_Reader',
'019_UAKB Изменение данных': '019_UAKB_User',
'019_UAKB Собственные объекты': '019_UAKB_User_Lite',
'020_BigData Администратор': '020_BIGData_Adm',
'020_BigData Чтение данных': '020_BIGData_Reader',
'020_BigData Изменение данных': '020_BIGData_User',
'021_ADD_ATTR Администратор': '021_add_attr_adm',
'021_ADD_ATTR Чтение данных':	'021_add_attr_reader',
'021_ADD_ATTR Изменение данных': '021_add_attr_user',
'021_ADD_ATTR собственные объекты': '021_add_attr_user_lite',
'022_Treasury_SBX Администратор': '022_Treasury_Adm',
'022_Treasury_SBX Чтение данных': '022_Treasury_Reader',
'022_Treasury_SBX Изменение данных': '022_Treasury_User',
'022_Treasury_SBX Собственные объекты': '022_Treasury_User_Lite',
'023_TBO2_DC Администратор': '023_TBO2_DC_Adm',
'023_TBO2_DC Чтение данных': '023_TBO2_DC_Reader',
'023_TBO2_DC Изменение данных': '023_TBO2_DC_User',
'023_TBO2_DC Собственные объекты': '023_TBO2_DC_User_Lite',
'024_DF_Retail Администратор': '024_DF_Retail_Adm',
'024_DF_Retail Чтение данных': '024_DF_Retail_Reader',
'024_DF_Retail Изменение данных': '024_DF_Retail_User',
'024_DF_Retail Собственные объекты': '024_DF_Retail_User_Lite',
'026_UKCP Администратор': '026_UKCP_Adm',
'026_UKCP Чтение данных': '026_UKCP_Reader',
'026_UKCP Изменение данных': '026_UKCP_User',
'026_UKCP Собственные объекты': '026_UKCP_User_Lite',
'027_TVA Администратор': '027_TVA_Adm',
'027_TVA Чтение данных': '027_TVA_Reader',
'027_TVA Изменение данных': '027_TVA_User',
'027_TVA Собственные объекты': '027_TVA_User_Lite',
'028_CB_CRAnalyse Администратор': '028_CB_CRAnalyse_Adm',
'028_CB_CRAnalyse Чтение данных': '028_CB_CRAnalyse_Reader',
'028_CB_CRAnalyse Изменение данных': '028_CB_CRAnalyse_User',
'028_CB_CRAnalyse Собственные объекты': '028_CB_CRAnalyse_User_Lite',
'029_DF_FUND Администратор': '029_DF_FUND_Adm',
'029_DF_FUND Чтение данных': '029_DF_FUND_Reader',
'029_DF_FUND Изменение данных': '029_DF_FUND_User',
'029_DF_FUND Собственные объекты': '029_DF_FUND_User_Lite',
'030_MIS_Platform Администратор': '030_MIS_Platform_Adm',
'030_MIS_Platform Чтение данных': '030_MIS_Platform_Reader',
'030_MIS_Platform Изменение данных': '030_MIS_Platform_User',
'030_MIS_Platform Собственные объекты': '030_MIS_Platform_User_Lite',
'030_MIS_Platform_VD Администратор': '030_MIS_Platform_VD_Adm',
'030_MIS_Platform_VD Чтение данных': '030_MIS_Platform_VD_Reader',
'030_MIS_Platform_VD Изменение данных': '030_MIS_Platform_VD_User',
'030_MIS_Platform_VD Собственные объекты': '030_MIS_Platform_VD_User_Lite',
'030_VD_MIS3_APP Администратор': '030_VD_MIS3_APP_Adm',
'030_VD_MIS3_APP Чтение данных': '030_VD_MIS3_APP_Reader',
'030_VD_MIS3_APP Изменение данных': '030_VD_MIS3_APP_User',
'030_VD_MIS3_APP Собственные объекты': '030_VD_MIS3_APP_User_Lite',
'031_CIB_Reports Администратор': '031_CIB_Reports_Adm',
'031_CIB_Reports Чтение данных': '031_CIB_Reports_Reader',
'031_CIB_Reports Изменение данных': '031_CIB_Reports_User',
'031_CIB_Reports Собственные объекты': '031_CIB_Reports_User_Lite',
'032_B21 Администратор':	'032_B21_Adm',
'032_B21 Чтение данных': '032_B21_Reader',
'032_B21 Изменение данных': '032_B21_User',
'032_B21 Собственные объекты': '032_B21_Reader',
'DLUAT_OAKB Администратор': 'DLUAT_OAKB_Adm',
'DLUAT_OAKB Пользователь Витрин': 'DLUAT_OAKB_Reader',
'DLUAT_OAKB Пользователь BI CRM': 'DLUAT_ROLE_BICRM',
'DLUAT_OAKB Аналитик': 'DLUAT_OAKB_User',
'DLPRD_OAKB Администратор': 'DLPRD_OAKB_Adm',
'DLPRD_OAKB Пользователь Витрин': 'DLPRD_OAKB_User',
'DLPRD_OAKB Пользователь BI CRM': 'DLPRD_ROLE_BICRM',
'DLPRD_OAKB Аналитик': 'DLPRD_OAKB_Reader',
'033_Risk Администратор': '033_Risk_Adm',
'033_Risk Чтение данных': '033_Risk_Reader',
'033_Risk Изменение данных': '033_Risk_User',
'033_Risk Собственные объекты': '033_Risk_User_Lite',
'SBX001_MIS_Retail_Arch Администратор': 'SBX001_MIS_Ret_Arch_Adm',
'SBX001_MIS_Retail_Arch Чтение данных': 'SBX001_MIS_Ret_Arch_Read',
'SBX001_MIS_Retail_Arch Изменение данных': 'SBX001_MIS_Ret_Arch_User',
'SBX001_MIS_Retail_Arch Собственные объекты':'SBX001_MIS_Ret_Arch_User_Li',
'SBX_034_SAPHR Администратор': 'SBX_034_Role_Adm',
'SBX_034_SAPHR Технологическая УЗ': 'SBX_034_Role_User_ETL',
'Аналитик РБ Чтение данных(Конфиденциально)': 'SBX_034_Retail_CONF_Reader',
'SBX_034 Аналитик РБ Чтение(Общий доступ)': 'SBX_034_Retail_BASE_Reader',
'Аналитик КБ Чтение данных(Конфиденциально)': 'SBX_034_Corp_CONF_Reader',
'SBX_034 Аналитик КБ Чтение(Общий доступ)': 'SBX_034_Corp_BASE_Reader',
'Аналитик УРПА Чтение данных(Конфиденциально)': 'SBX_034_Assets_CONF_Reader',
'SBX_034 Аналитик УРПА Чтение(Общий доступ)': 'SBX_034_Assets_BASE_Reader',
'Аналитик ДФ и ДКП Чтение данных(Конфиденциально)': 'SBX_034_Full_CONF_Reader',
'SBX_034 Аналитик ДФ и ДКП Чтение(Общий доступ)': 'SBX_034_Full_BASE_Reader',
'030_VD_MIS3_APP Администратор': '030_VD_MIS3_APP_Adm',
'030_VD_MIS3_APP Чтение данных': '030_VD_MIS3_APP_Reader',
'030_VD_MIS3_APP Изменение данных': '030_VD_MIS3_APP_User',
'030_VD_MIS3_APP Собственные объекты': '030_VD_MIS3_APP_User_Lite',
'АС ЦХД Раздел 0': 'PRD3_ROLE_Business_Analyst',
'АС ЦХД Раздел 1': 'PRD3_1_ROLE_Business_Analyst',
'АС ЦХД Доступ к витринам': 'PRD3_RL_VD_Business_Analyst',
'Витрина УАКБ-3(владелец Розничный бизнес)': 'PRD3_1_DMUAKB3_Role',
'SBX001_MIS_Retail_Arch Администратор': 'SBX001_MIS_Ret_Arch_Adm',
'SBX001_MIS_Retail_Arch Чтение данных': 'SBX001_MIS_Ret_Arch_Read',
'SBX001_MIS_Retail_Arch Изменение данных': 'SBX001_MIS_Ret_Arch_User', 
'SBX001_MIS_Retail_Arch Собственные объекты': 'SBX001_MIS_Ret_Arch_User_Li',
'PAN_001_GM – Администратор': 'PAN_001_GM_Adm',
'PAN_001_GM - Чтение данных': 'PAN_001_GM_Reader',
'PAN_001_GM – Собственные объекты': 'PAN_001_GM_User_Lite',
'PAN_001_GM – Изменение данных': 'PAN_001_GM_User',
'SBX_036_BS Чтение данных': 'SBX_036_BS_Reader'
}



def get_role(text):
    res = []
    roles = []    
    error_roles = []
    result_dict = {}
    s = ''
    text = text.split('\n')
    for key, value in roles_list.items():
        roles_list[key.lower()] = roles_list.pop(key)
    for item in text:
        if item != '':
            s = (re.sub(r' \([^)]*\)', '', item))
            res.append(re.sub(r'\d+[.] ', '', s))
    for role in res:
        try:
            roles.append(roles_list[role.lower()])
        except KeyError:
            error_roles.append(role)
        result_dict["ok"] = roles
        result_dict["error"] = error_roles
    return result_dict

